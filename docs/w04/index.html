<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Amit Arora and Jeff Jacobs">

<title>Week 4: DuckDB, Polars, File Formats – DSAN 6000 Slide Hub</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-bc185b5c5bdbcb35c2eb49d8a876ef70.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a14e3238c51140e99ccc48519b6ed9ce.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-ccd81253fefb92e9cd3f9eb5b5d87b54.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-a14e3238c51140e99ccc48519b6ed9ce.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" '="" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/dreampulse/computer-modern-web-font@master/fonts.css"><script src="../sidebar.js"></script><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Honk&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../dsan-globals/jjstyles.css">
</head>

<body class="nav-sidebar floating slimcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../w04/index.html">Week 4: <span class="sec-w04-date">Sep 15</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">DSAN 6000 Slide Hub</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://gu-dsan.github.io/6000-fall-2025/" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-arrow-left-short pe-1"></i> Main Course Page</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1: Aug 28</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2: <span class="sec-w02-date">Sep 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3: <span class="sec-w03-date">Sep 8</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w04/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Week 4: <span class="sec-w04-date">Sep 15</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5: <span class="sec-w05-date">Sep 22</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6: <span class="sec-w06-date">Sep 29</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w07/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7: <span class="sec-w07-date">Oct 6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w08/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8: <span class="sec-w08-date">Oct 20</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w09/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 9: <span class="sec-w09-date">Oct 27</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w10/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 10: <span class="sec-w10-date">Nov 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w11/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 11: <span class="sec-w11-date">Nov 10</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w12/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 12: <span class="sec-w12-date">Nov 17</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w13/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 13: <span class="sec-w13-date">Nov 24</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w14/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 14: <span class="sec-w14-date">Dec 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w15/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 15: <span class="sec-w15-date">Dec 8</span></span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.zoom.us/j/91628796534?pwd=BSnBpL4VeysAQMbUtbH4MmwOunglLh.1" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">S01 (Mon) Zoom Link <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.zoom.us/j/92724737140?pwd=rIyVrsa3CDq9xCv4LGNX3Cq0o2J3An.1" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">S02 (Thu) Zoom Link <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.hosted.panopto.com/Panopto/Pages/Sessions/List.aspx?folderID=9ebe4700-c41f-434a-bb78-b34801332737" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Recordings <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://jjacobs.me/meet" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Book Office Hour <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p><em>Updated 2025-09-29, 03:25:13 PM</em></p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#agenda-and-goals-for-today" id="toc-agenda-and-goals-for-today" class="nav-link active" data-scroll-target="#agenda-and-goals-for-today">Agenda and Goals for Today</a></li>
  <li><a href="#logistics-and-review" id="toc-logistics-and-review" class="nav-link" data-scroll-target="#logistics-and-review">Logistics and Review</a></li>
  <li><a href="#filesystems" id="toc-filesystems" class="nav-link" data-scroll-target="#filesystems">Filesystems</a>
  <ul class="collapse">
  <li><a href="#raw-ingredients-of-storage-systems" id="toc-raw-ingredients-of-storage-systems" class="nav-link" data-scroll-target="#raw-ingredients-of-storage-systems">Raw Ingredients of Storage Systems</a></li>
  <li><a href="#single-machine-vs.-distributed-storage" id="toc-single-machine-vs.-distributed-storage" class="nav-link" data-scroll-target="#single-machine-vs.-distributed-storage">Single-Machine vs.&nbsp;Distributed Storage</a></li>
  <li><a href="#file-storage-types" id="toc-file-storage-types" class="nav-link" data-scroll-target="#file-storage-types">File Storage Types</a></li>
  <li><a href="#object-stores" id="toc-object-stores" class="nav-link" data-scroll-target="#object-stores">Object Stores</a></li>
  <li><a href="#distributed-fs-vs-object-store" id="toc-distributed-fs-vs-object-store" class="nav-link" data-scroll-target="#distributed-fs-vs-object-store">Distributed FS vs Object Store</a></li>
  <li><a href="#before-data-locality-for-hadoop" id="toc-before-data-locality-for-hadoop" class="nav-link" data-scroll-target="#before-data-locality-for-hadoop">Before: Data locality (for Hadoop)</a></li>
  <li><a href="#today-de-coupling-storage-from-compute" id="toc-today-de-coupling-storage-from-compute" class="nav-link" data-scroll-target="#today-de-coupling-storage-from-compute">Today: De-Coupling Storage from Compute</a></li>
  <li><a href="#data-on-disk-formats" id="toc-data-on-disk-formats" class="nav-link" data-scroll-target="#data-on-disk-formats">Data-on-Disk Formats</a></li>
  <li><a href="#plain-text-csv-tsv-fwf" id="toc-plain-text-csv-tsv-fwf" class="nav-link" data-scroll-target="#plain-text-csv-tsv-fwf">Plain Text (CSV, TSV, FWF)</a></li>
  <li><a href="#json" id="toc-json" class="nav-link" data-scroll-target="#json">JSON</a></li>
  <li><a href="#binary-files" id="toc-binary-files" class="nav-link" data-scroll-target="#binary-files">Binary Files</a></li>
  <li><a href="#issues-with-common-file-formats-especially-csv" id="toc-issues-with-common-file-formats-especially-csv" class="nav-link" data-scroll-target="#issues-with-common-file-formats-especially-csv">Issues with Common File Formats (Especially CSV)</a></li>
  <li><a href="#introducing-apache-parquet" id="toc-introducing-apache-parquet" class="nav-link" data-scroll-target="#introducing-apache-parquet">Introducing Apache Parquet</a></li>
  <li><a href="#traditional-row-store" id="toc-traditional-row-store" class="nav-link" data-scroll-target="#traditional-row-store">Traditional Row-Store</a></li>
  <li><a href="#column-store" id="toc-column-store" class="nav-link" data-scroll-target="#column-store">Column-Store</a></li>
  <li><a href="#row-groups" id="toc-row-groups" class="nav-link" data-scroll-target="#row-groups">Row Groups</a></li>
  <li><a href="#metadata-compression-and-dictionary-encoding" id="toc-metadata-compression-and-dictionary-encoding" class="nav-link" data-scroll-target="#metadata-compression-and-dictionary-encoding">Metadata, compression, and dictionary encoding</a></li>
  <li><a href="#apache-arrow-for-in-memory-analytics" id="toc-apache-arrow-for-in-memory-analytics" class="nav-link" data-scroll-target="#apache-arrow-for-in-memory-analytics">Apache Arrow for In-Memory Analytics</a></li>
  <li><a href="#before-arrow" id="toc-before-arrow" class="nav-link" data-scroll-target="#before-arrow">Before Arrow</a></li>
  <li><a href="#after-arrow" id="toc-after-arrow" class="nav-link" data-scroll-target="#after-arrow">After Arrow</a></li>
  <li><a href="#arrow-compatibility" id="toc-arrow-compatibility" class="nav-link" data-scroll-target="#arrow-compatibility">Arrow Compatibility</a></li>
  <li><a href="#arrow-performance" id="toc-arrow-performance" class="nav-link" data-scroll-target="#arrow-performance">Arrow Performance</a></li>
  <li><a href="#using-arrow-with-csv-and-parquet" id="toc-using-arrow-with-csv-and-parquet" class="nav-link" data-scroll-target="#using-arrow-with-csv-and-parquet">Using Arrow with CSV and Parquet</a></li>
  </ul></li>
  <li><a href="#polars" id="toc-polars" class="nav-link" data-scroll-target="#polars">Polars</a>
  <ul class="collapse">
  <li><a href="#before-we-begin" id="toc-before-we-begin" class="nav-link" data-scroll-target="#before-we-begin">Before We Begin…</a></li>
  <li><a href="#polars-1" id="toc-polars-1" class="nav-link" data-scroll-target="#polars-1">Polars</a></li>
  <li><a href="#why-is-polars-faster-than-pandas" id="toc-why-is-polars-faster-than-pandas" class="nav-link" data-scroll-target="#why-is-polars-faster-than-pandas">Why is Polars Faster than Pandas?</a></li>
  <li><a href="#ease-of-use" id="toc-ease-of-use" class="nav-link" data-scroll-target="#ease-of-use">Ease of Use</a></li>
  <li><a href="#ease-of-use-contd." id="toc-ease-of-use-contd." class="nav-link" data-scroll-target="#ease-of-use-contd.">Ease of Use (contd.)</a></li>
  <li><a href="#installation-data-loading-and-basic-operations" id="toc-installation-data-loading-and-basic-operations" class="nav-link" data-scroll-target="#installation-data-loading-and-basic-operations">Installation, Data Loading, and Basic Operations</a></li>
  <li><a href="#polars-pipeline-example" id="toc-polars-pipeline-example" class="nav-link" data-scroll-target="#polars-pipeline-example">Polars Pipeline Example</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading">Further reading</a></li>
  </ul></li>
  <li><a href="#duckdb" id="toc-duckdb" class="nav-link" data-scroll-target="#duckdb">DuckDB</a>
  <ul class="collapse">
  <li><a href="#duckdb-1" id="toc-duckdb-1" class="nav-link" data-scroll-target="#duckdb-1">DuckDB</a></li>
  <li><a href="#key-features" id="toc-key-features" class="nav-link" data-scroll-target="#key-features">Key Features</a></li>
  <li><a href="#use-cases-for-duckdb" id="toc-use-cases-for-duckdb" class="nav-link" data-scroll-target="#use-cases-for-duckdb">Use Cases for DuckDB</a></li>
  <li><a href="#duckdb-diy" id="toc-duckdb-diy" class="nav-link" data-scroll-target="#duckdb-diy">DuckDB: DIY</a></li>
  <li><a href="#duckdb-fully-managed" id="toc-duckdb-fully-managed" class="nav-link" data-scroll-target="#duckdb-fully-managed">DuckDB: Fully-Managed</a></li>
  <li><a href="#setting-up-duckdb" id="toc-setting-up-duckdb" class="nav-link" data-scroll-target="#setting-up-duckdb">Setting Up DuckDB</a></li>
  <li><a href="#setting-up-duckdb-contd." id="toc-setting-up-duckdb-contd." class="nav-link" data-scroll-target="#setting-up-duckdb-contd.">Setting Up DuckDB (contd.)</a></li>
  <li><a href="#querying-duckdb" id="toc-querying-duckdb" class="nav-link" data-scroll-target="#querying-duckdb">Querying DuckDB</a></li>
  <li><a href="#querying-duckdb-contd." id="toc-querying-duckdb-contd." class="nav-link" data-scroll-target="#querying-duckdb-contd.">Querying DuckDB (contd.)</a></li>
  <li><a href="#using-the-duckdb-cli-and-shell" id="toc-using-the-duckdb-cli-and-shell" class="nav-link" data-scroll-target="#using-the-duckdb-cli-and-shell">Using the DuckDB CLI and Shell</a></li>
  <li><a href="#profiling-in-duckdb" id="toc-profiling-in-duckdb" class="nav-link" data-scroll-target="#profiling-in-duckdb">Profiling in DuckDB</a></li>
  <li><a href="#benchmarks-and-comparisons" id="toc-benchmarks-and-comparisons" class="nav-link" data-scroll-target="#benchmarks-and-comparisons">Benchmarks and Comparisons</a></li>
  <li><a href="#further-reading-on-duckdb" id="toc-further-reading-on-duckdb" class="nav-link" data-scroll-target="#further-reading-on-duckdb">Further Reading on DuckDB</a></li>
  </ul></li>
  <li><a href="#lab-4" id="toc-lab-4" class="nav-link" data-scroll-target="#lab-4">Lab 4</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jpowerj/dsan6000/blob/main/w04/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 4: DuckDB, Polars, File Formats</h1>
<p class="subtitle lead"><em>DSAN 6000: Big Data and Cloud Computing</em><br>Fall 2025</p>
  <div class="quarto-categories">
    <div class="quarto-category">Class Sessions</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Amit Arora and Jeff Jacobs </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="mailto:jj1088@georgetown.edu" target="_blank"><code>jj1088@georgetown.edu</code></a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Monday, September 15, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<center class="mb-3">
<a class="h2" href="./slides.html" target="_blank">Open slides in new tab →</a>
</center>
<section id="agenda-and-goals-for-today" class="level2">
<h2 class="anchored" data-anchor-id="agenda-and-goals-for-today">Agenda and Goals for Today</h2>
<div class="columns">
<div class="column" style="width:50%;">
<section id="lecture" class="level3">
<h3 class="anchored" data-anchor-id="lecture">Lecture</h3>
<ul>
<li>Distributed file systems</li>
<li>Modern file types</li>
<li>Working with large tabular data on a single node
<ul>
<li>DuckDB</li>
<li>Polars</li>
</ul></li>
</ul>
</section>
</div><div class="column" style="width:50%;">
<section id="lab" class="level3">
<h3 class="anchored" data-anchor-id="lab">Lab</h3>
<ul>
<li>Run a similar task with Pandas, polars and duckdb</li>
</ul>
</section>
</div>
</div>
</section>
<section id="logistics-and-review" class="level2 smaller crunch-title crunch-p">
<h2 class="smaller crunch-title crunch-p anchored" data-anchor-id="logistics-and-review">Logistics and Review</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><strong>Deadlines</strong></p>
<ul>
<li><del>Assignment 1: Python Skills <strong>Due Sept 5 11:59pm</strong></del></li>
<li><del>Lab 2: Cloud Tooling <strong>Due Sept 5 6pm</strong></del></li>
<li><del>Assignment 2: Shell &amp; Linux <strong>Due Sept 11 11:59pm</strong></del></li>
<li><del>Lab 3: Parallel Computing <strong>Due Sept 12 6pm</strong></del></li>
<li>Assignment 3: Parallelization <strong>Due Sept 18 11:59pm</strong></li>
<li>Lab 4: Docker and Lambda <strong>Due Sept 19 6pm</strong></li>
<li>Assignment 4: Containers <strong>Due Sept 25 11:59pm</strong></li>
<li>Lab 5: DuckDB &amp; Polars <strong>Due Sept 26 6pm</strong></li>
</ul>
</div><div class="column" style="width:40%;">
<p><strong>Look back and ahead</strong></p>
<ul>
<li>Continue to use Slack for questions!</li>
<li>Docker (containerization)</li>
<li>Lambda functions</li>
<li>Coming up: Spark and project</li>
</ul>
</div>
</div>
<!-- Start _filesystems.qmd -->
</section>
<section id="filesystems" class="level1 page-columns page-full" data-stack-name="Filesystems">
<h1 data-stack-name="Filesystems">Filesystems</h1>
<section id="raw-ingredients-of-storage-systems" class="level2 title-09">
<h2 class="title-09 anchored" data-anchor-id="raw-ingredients-of-storage-systems">Raw Ingredients of Storage Systems</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Disk drives (magnetic HDDs or SSDs)</li>
<li>RAM</li>
<li>Networking and CPU</li>
<li>Serialization</li>
<li>Compression</li>
<li>Caching</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fode_0602.png" height="500" class="figure-img"></p>
<figcaption>From <span class="citation" data-cites="reis_fundamentals_2022">Reis and Housley (<a href="#ref-reis_fundamentals_2022" role="doc-biblioref">2022</a>)</span></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="single-machine-vs.-distributed-storage" class="level2 title-09 crunch-title text-90 crunch-p">
<h2 class="title-09 crunch-title text-90 crunch-p anchored" data-anchor-id="single-machine-vs.-distributed-storage">Single-Machine vs.&nbsp;Distributed Storage</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fode_0604.png" class="img-fluid figure-img"></p>
<figcaption>From <span class="citation" data-cites="reis_fundamentals_2022">Reis and Housley (<a href="#ref-reis_fundamentals_2022" role="doc-biblioref">2022</a>)</span></figcaption>
</figure>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<center>
<p><strong>Single-Machine</strong></p>
</center>
<ul>
<li>They are commonly used for storing operating system files, application files, and user data files.</li>
<li>Filesystems are also used in databases to store data files, transaction logs, and backups.</li>
</ul>
</div><div class="column" style="width:50%;">
<center>
<p><strong>Distributed Storage</strong></p>
</center>
<ul>
<li>A distributed filesystem is a type of filesystem that spans multiple computers.</li>
<li>It provides a unified view of files across all the computers in the system.</li>
<li>Have existed before cloud</li>
</ul>
</div>
</div>
</section>
<section id="file-storage-types" class="level2 smaller crunch-title">
<h2 class="smaller crunch-title anchored" data-anchor-id="file-storage-types">File Storage Types</h2>
<div class="columns">
<div class="column" style="width:30%;">
<center>
<p><strong>Local Disk</strong></p>
</center>
<ul>
<li>OS-managed filesystems on local disk partition:</li>
<li>NTFS (Windows)</li>
<li>HFS+ (MacOS)</li>
<li>ext4 (Linux)() on a local disk partition of SSD or magnetic disk</li>
</ul>
</div><div class="column" style="width:30%;">
<center>
<p><span class="text-90"><strong>Network-Attached (NAS)</strong></span></p>
</center>
<ul>
<li>Accessed by clients over a network</li>
<li>Redundancy and reliability, fine-grained control of resources, storage pooling across multiple disks for large virtual volumes, and file sharing across multiple machines</li>
</ul>
</div><div class="column" style="width:40%;">
<p><strong>Cloud Filesystems</strong></p>
<ul>
<li><strong>Not object store (more on that later)</strong></li>
<li><strong>Not the virtual hard drive attached to a virtual machine</strong></li>
<li>Fully managed: Takes care of networking, managing disk clusters, failures, and configuration (Azure Files, Amazon Elastic Filesystem)</li>
<li>Backed by Object Store</li>
</ul>
</div>
</div>
<p><span class="text-70">Based on <span class="citation" data-cites="reis_fundamentals_2022">Reis and Housley (<a href="#ref-reis_fundamentals_2022" role="doc-biblioref">2022</a>)</span></span></p>
</section>
<section id="object-stores" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="object-stores">Object Stores</h2>
<ul>
<li>Somewhat confusing because <strong>object</strong> has several meanings in computer science.</li>
<li>In this context, we’re talking about a specialized file-like construct. It could be any type of file: TXT, CSV, JSON, images, videos, audio</li>
</ul>
<div class="quarto-layout-panel" data-layout="[33, 33, 33]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="cell1" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/s3-blob.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="cell2" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="images/fode_0608.png" class="img-fluid"></p>
</div>
<div id="cell3" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="images/object-storage-structure.png" class="img-fluid"></p>
</div>
</div>
</div>
<ul>
<li>Contains objects of all shapes and sizes: each gets a <strong>unique identifier</strong></li>
<li>Objects are <strong>immutable</strong>: cannot be modified in place (unlike local FS)</li>
</ul>
</section>
<section id="distributed-fs-vs-object-store" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="distributed-fs-vs-object-store">Distributed FS vs Object Store</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Distributed File System</th>
<th>Object Storage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Organization</td>
<td>Files in hierarchical directories</td>
<td>Flat organization (though there can be overlays to provide hierarchical files structure)</td>
</tr>
<tr class="even">
<td>Method</td>
<td>POSIX File Operations</td>
<td>REST API</td>
</tr>
<tr class="odd">
<td>Immutability</td>
<td>None: Random writes anywhere in file</td>
<td>Immutable: need to replace/append entire object</td>
</tr>
<tr class="even">
<td>Performance</td>
<td>Performs best for smaller files</td>
<td>Performs best for large files</td>
</tr>
<tr class="odd">
<td>Scalability</td>
<td>Millions of files</td>
<td>Billions of objects</td>
</tr>
</tbody>
</table>
<p>Both provide:</p>
<ul>
<li>Fault tolerance</li>
<li>Availability and consistency</li>
</ul>
</section>
<section id="before-data-locality-for-hadoop" class="level2">
<h2 class="anchored" data-anchor-id="before-data-locality-for-hadoop">Before: Data locality (for Hadoop)</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/hdg-0202.png" height="500" class="figure-img"></p>
<figcaption>From <span class="citation" data-cites="white_hadoop_2015">White (<a href="#ref-white_hadoop_2015" role="doc-biblioref">2015</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="today-de-coupling-storage-from-compute" class="level2 title-08">
<h2 class="title-08 anchored" data-anchor-id="today-de-coupling-storage-from-compute">Today: De-Coupling Storage from Compute</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tcdl_0106.png" class="img-fluid figure-img"></p>
<figcaption>From <span class="citation" data-cites="gopalan_cloud_2022">Gopalan (<a href="#ref-gopalan_cloud_2022" role="doc-biblioref">2022</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="data-on-disk-formats" class="level2">
<h2 class="anchored" data-anchor-id="data-on-disk-formats">Data-on-Disk Formats</h2>
<ul>
<li>Plain Text (CSV, TSV, FWF)</li>
<li>JSON</li>
<li>Binary Files</li>
</ul>
</section>
<section id="plain-text-csv-tsv-fwf" class="level2">
<h2 class="anchored" data-anchor-id="plain-text-csv-tsv-fwf">Plain Text (CSV, TSV, FWF)</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://meme-generator.com/wp-content/uploads/mememe/2021/04/we-shared-the-csv-with-a-different-separator-335529-1.jpg" class="quarto-figure quarto-figure-center figure-img" height="400"></p>
</figure>
</div>
<ul>
<li>Pay attention to encodings!</li>
<li>Lines end in linefeed, carriage-return, or both together depending on the OS that generated</li>
<li>Typically, a single line of text contains a single record</li>
</ul>
</section>
<section id="json" class="level2 crunch-title text-75">
<h2 class="crunch-title text-75 anchored" data-anchor-id="json">JSON</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>JSON files have two flavors: <code>JSON Lines</code> vs.&nbsp;<code>JSON</code>. Typically when we say data is in JSON format, we imply it’s <code>JSON Lines</code> which means that there is a single JSON object per line, and there are multiple lines.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>JSON Lines</strong></p>
<p>4 records, one per line, no end comma</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span><span class="st">"marck"</span><span class="fu">,</span> <span class="dt">"last_name"</span><span class="fu">:</span><span class="st">"vaisman"</span><span class="fu">}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span><span class="st">"anderson"</span><span class="fu">,</span> <span class="dt">"last_name"</span><span class="fu">:</span><span class="st">"monken"</span><span class="fu">}</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span><span class="dv">3</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span><span class="st">"amit"</span><span class="fu">,</span> <span class="dt">"last_name"</span><span class="fu">:</span><span class="st">"arora"</span><span class="fu">}</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span><span class="st">"abhijit"</span><span class="fu">,</span> <span class="dt">"last_name"</span><span class="fu">:</span><span class="st">"dasgupta"</span><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<p><strong>JSON</strong></p>
<p>4 records enclosed in 1 JSON Array</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span><span class="st">"marck"</span><span class="fu">,</span> <span class="dt">"last_name"</span><span class="fu">:</span><span class="st">"vaisman"</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span><span class="st">"anderson"</span><span class="fu">,</span> <span class="dt">"last_name"</span><span class="fu">:</span><span class="st">"monken"</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span><span class="dv">3</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span><span class="st">"amit"</span><span class="fu">,</span> <span class="dt">"last_name"</span><span class="fu">:</span><span class="st">"arora"</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span><span class="st">"abhijit"</span><span class="fu">,</span> <span class="dt">"last_name"</span><span class="fu">:</span><span class="st">"dasgupta"</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="binary-files" class="level2">
<h2 class="anchored" data-anchor-id="binary-files">Binary Files</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/bin_1956.webp" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="issues-with-common-file-formats-especially-csv" class="level2 smaller title-09">
<h2 class="smaller title-09 anchored" data-anchor-id="issues-with-common-file-formats-especially-csv">Issues with Common File Formats (Especially CSV)</h2>
<ul>
<li><strong>Ubiquitous</strong> but highly <strong>error-prone</strong></li>
<li>Default delimiter: familiar character in English, the <strong>comma</strong></li>
<li>Ambiguities:
<ul>
<li>Delimiter (comma, tab, semi-colon, custom)</li>
<li>Quote characters (single or doble quote)</li>
<li>Escaping to appropriately handle string data</li>
</ul></li>
<li>Doesn’t natively encode schema information</li>
<li>No direct support for <strong>nested</strong> structures</li>
<li>Encoding+schema must be configured on target system to ensure ingestion</li>
<li><strong>Autodetection</strong> provided in many cloud environments but is inappropriate for production ingestion (can be painfully slow)</li>
<li><strong>Data engineers</strong> often forced to work with CSV data and then build robust <strong>exception handling</strong> and <strong>error detection</strong> to ensure data quality (<strong>Pydantic!</strong>)</li>
</ul>
</section>
<section id="introducing-apache-parquet" class="level2">
<h2 class="anchored" data-anchor-id="introducing-apache-parquet">Introducing Apache Parquet</h2>
<ul>
<li>Free, open-source, column-oriented data storage format created by Twitter and Cloudera (v1.0 released July 2013)</li>
<li>Data stored in <strong>columnar format</strong> (as opposed to <strong>row</strong> format), designed for read and write performance</li>
<li><strong>Builds in schema information</strong> and natively supports <strong>nested</strong> data</li>
<li>Supported by R and Python through <a href="https://arrow.apache.org/">Apache Arrow</a> (more coming up!)</li>
</ul>
</section>
<section id="traditional-row-store" class="level2">
<h2 class="anchored" data-anchor-id="traditional-row-store">Traditional Row-Store</h2>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="col1" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Row-store-1024x576.webp" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="col2" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Row-based-scan-1024x576.webp" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Query: <em>“How many balls did we sell?</em></li>
<li>The engine must scan each and every row until the end!</li>
</ul>
</section>
<section id="column-store" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="column-store">Column-Store</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Column-store-1024x576.webp" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><a href="https://data-mozart.com/parquet-file-format-everything-you-need-to-know/">Parquet file format, everything you need to know</a></p>
</div></div></section>
<section id="row-groups" class="level2 text-90">
<h2 class="text-90 anchored" data-anchor-id="row-groups">Row Groups</h2>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="col1" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><strong>Data is stored in row groups!</strong></p>
<p><img src="images/Row-store-1024x576.webp" class="img-fluid"></p>
</div>
<div id="col2" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><strong>Only required fields</strong></p>
<p><img src="images/Row-based-scan-1024x576.webp" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="metadata-compression-and-dictionary-encoding" class="level2">
<h2 class="anchored" data-anchor-id="metadata-compression-and-dictionary-encoding">Metadata, compression, and dictionary encoding</h2>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="col1" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Format-1024x576.webp" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="col2" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Dictionary-1024x576.webp" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="apache-arrow-for-in-memory-analytics" class="level2 title-09">
<h2 class="title-09 anchored" data-anchor-id="apache-arrow-for-in-memory-analytics">Apache Arrow for In-Memory Analytics</h2>
<blockquote class="blockquote">
<p>Apache Arrow is a development platform for in-memory analytics. It contains a set of technologies that enable big data systems to process and move data fast. It specifies a standardized language-independent columnar memory format for flat and hierarchical data, organized for efficient analytic operations on modern hardware. <span class="citation" data-cites="topol_inmemory_2024">(<a href="#ref-topol_inmemory_2024" role="doc-biblioref">Topol and McKinney 2024</a>)</span></p>
</blockquote>
</section>
<section id="before-arrow" class="level2">
<h2 class="anchored" data-anchor-id="before-arrow">Before Arrow</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/before-arrow.jpg" class="img-fluid figure-img"></p>
<figcaption><span class="citation" data-cites="topol_inmemory_2024">Topol and McKinney (<a href="#ref-topol_inmemory_2024" role="doc-biblioref">2024</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="after-arrow" class="level2">
<h2 class="anchored" data-anchor-id="after-arrow">After Arrow</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/after-arrow.jpg" class="img-fluid figure-img"></p>
<figcaption><span class="citation" data-cites="topol_inmemory_2024">Topol and McKinney (<a href="#ref-topol_inmemory_2024" role="doc-biblioref">2024</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="arrow-compatibility" class="level2">
<h2 class="anchored" data-anchor-id="arrow-compatibility">Arrow Compatibility</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/data-processing.jpg" class="img-fluid figure-img"></p>
<figcaption><span class="citation" data-cites="topol_inmemory_2024">Topol and McKinney (<a href="#ref-topol_inmemory_2024" role="doc-biblioref">2024</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="arrow-performance" class="level2">
<h2 class="anchored" data-anchor-id="arrow-performance">Arrow Performance</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/file-size-perf-numbers.jpg" class="img-fluid figure-img"></p>
<figcaption><span class="citation" data-cites="topol_inmemory_2024">Topol and McKinney (<a href="#ref-topol_inmemory_2024" role="doc-biblioref">2024</a>)</span></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/mean-calc-mem-runtime.jpg" class="img-fluid figure-img"></p>
<figcaption><span class="citation" data-cites="topol_inmemory_2024">Topol and McKinney (<a href="#ref-topol_inmemory_2024" role="doc-biblioref">2024</a>)</span></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="using-arrow-with-csv-and-parquet" class="level2">
<h2 class="anchored" data-anchor-id="using-arrow-with-csv-and-parquet">Using Arrow with CSV and Parquet</h2>
<div class="columns">
<div class="column" style="width:50%;">
<center>
<p><strong>Python</strong></p>
</center>
<p><code>pyarrow</code> or from <code>pandas</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pd.read_csv(engine <span class="op">=</span> <span class="st">'pyarrow'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>pd.read_parquet()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow.csv</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>pyarrow.csv.read_csv()</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow.parquet</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>pyarrow.parquet.read_table()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<center>
<p><strong>R</strong></p>
</center>
<p>Use the <code>arrow</code> package</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv_arrow</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">read_parquet</span>()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">read_json_arrow</span>()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv_arrow</span>()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_parquet</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><strong>Recommendation:</strong> save your intermediate and analytical datasets as <code>Parquet</code>!</p>
<!-- Start _polars.qmd -->
</section>
</section>
<section id="polars" class="level1" data-stack-name="Polars">
<h1 data-stack-name="Polars">Polars</h1>
<p>Lightning-fast DataFrame library for Rust and Python</p>
<section id="before-we-begin" class="level2 text-90 crunch-title">
<h2 class="text-90 crunch-title anchored" data-anchor-id="before-we-begin">Before We Begin…</h2>
<blockquote class="blockquote">
<p><a href="https://pandas.pydata.org/">Pandas</a> is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.</p>
</blockquote>
<p>Pandas is slow, but less slow if you use it the right way!</p>
<ul>
<li><a href="https://wesmckinney.com/blog/apache-arrow-pandas-internals/">Apache Arrow and the “10 Things I Hate About pandas”</a> <font color="red" size="5">(A 2017 post from the creator of Pandas…)</font>)</li>
<li><a href="https://blog.esciencecenter.nl/irregular-data-in-pandas-using-c-88ce311cb9ef">50x faster data loading in Pandas: no problem</a> <font color="red" size="5">(an old 2019 article…)</font></li>
<li><a href="https://medium.com/@tommerrissin/is-pandas-really-that-slow-cff4352e4f58">Is Pandas really that slow?</a></li>
<li><a href="https://datapythonista.me/blog/pandas-20-and-the-arrow-revolution-part-i">Pandas 2.0 and the arrow revolution</a></li>
</ul>
</section>
<section id="polars-1" class="level2 crunch-title">
<h2 class="crunch-title anchored" data-anchor-id="polars-1">Polars</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/polars.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="why-is-polars-faster-than-pandas" class="level2 smaller crunch-title">
<h2 class="smaller crunch-title anchored" data-anchor-id="why-is-polars-faster-than-pandas">Why is Polars Faster than Pandas?</h2>
<ul>
<li><strong>Polars is written in Rust</strong>. Rust is <strong>compiled</strong>; Python is <strong>interpreted</strong>
<ul>
<li>Compiled language: you generate the machine code only once then run it, subsequent runs do not need the compilation step.</li>
<li>Interpreted language: code has to be parsed, interpreted and converted into machine code every single time.</li>
</ul></li>
<li><strong>Parallelization</strong>: Vectorized operations can be executed in parallel on multiple cores</li>
<li><strong>Lazy evaluation</strong>: Polars supports two APIs lazy as well as eager evaluation (used by pandas). In lazy evaluation, a query is executed only when required. While in eager evaluation, a query is executed immediately.</li>
<li><strong>Polars uses <a href="https://arrow.apache.org/">Arrow</a></strong> for in-memory data representation. Similar to how pandas uses NumPy (Pandas 2 allows using Arrow as backend)</li>
<li><strong>Polars <span class="math inline">\(\approx\)</span> in-memory DataFrame library + query optimizer</strong></li>
</ul>
<div class="notes">
<ul>
<li>[Excerpt from <a href="https://news.ycombinator.com/item?id=26454585">this post</a> from <a href="https://github.com/ritchie46">Ritchie Vink</a>, author of Polars] Arrow provides the efficient data structures and some compute kernels, like a SUM, a FILTER, a MAX etc. Arrow is not a query engine. Polars is a DataFrame library on top of arrow that has implemented efficient algorithms for JOINS, GROUPBY, PIVOTs, MELTs, QUERY OPTIMIZATION, etc. (the things you expect from a DF lib).</li>
</ul>
</div>
</section>
<section id="ease-of-use" class="level2 smaller crunch-title crunch-ul">
<h2 class="smaller crunch-title crunch-ul anchored" data-anchor-id="ease-of-use">Ease of Use</h2>
<ul>
<li><p>Familiar API for users of Pandas: differences in syntax but still a <strong>Dataframe API</strong> making it straightforward to perform common operations such as <em>filtering</em>, <em>aggregating</em>, and <em>joining</em> data</p></li>
<li><p>See <a href="https://pola-rs.github.io/polars-book/user-guide/migration/pandas/">Migrating from Pandas</a></p></li>
<li><p><strong>Reading data</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># must install s3fs -&gt; "pip install s3fs"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Polars</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>polars_df <span class="op">=</span> pl.read_parquet(<span class="st">"s3://nyc-tlc/trip data/yellow_tripdata_2023-06.parquet"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># using Pandas</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>pandas_df <span class="op">=</span> pd.read_parquet(<span class="st">"s3://nyc-tlc/trip data/yellow_tripdata_2023-06.parquet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>Selecting columns (see <a href="https://stackoverflow.com/questions/68713020/what-is-filter-pushdown-optimization">Pushdown optimization</a>)</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Polars</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>selected_columns_polars <span class="op">=</span> polars_df[[<span class="st">'column1'</span>, <span class="st">'column2'</span>]]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Pandas</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>selected_columns_pandas <span class="op">=</span> pandas_df[[<span class="st">'column1'</span>, <span class="st">'column2'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="ease-of-use-contd." class="level2 crunch-title crunch-ul">
<h2 class="crunch-title crunch-ul anchored" data-anchor-id="ease-of-use-contd.">Ease of Use (contd.)</h2>
<ul>
<li><p><strong>Filtering data</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Polars</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>filtered_polars <span class="op">=</span> polars_df[polars_df[<span class="st">'column1'</span>] <span class="op">&gt;</span> <span class="dv">10</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Pandas</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>filtered_pandas <span class="op">=</span> pandas_df[pandas_df[<span class="st">'column1'</span>] <span class="op">&gt;</span> <span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Though you can write Polars code that looks like Pandas, better to write <strong>idiomatic</strong> Polars code that takes advantage of Polars’ features</p></li>
<li><p><a href="https://pola-rs.github.io/polars-book/user-guide/migration/spark/">Migrating from Apache Spark</a>: Whereas Spark DataFrame is a collection of rows, Polars DataFrame is closer to a collection of columns</p></li>
</ul>
</section>
<section id="installation-data-loading-and-basic-operations" class="level2 title-10 smaller">
<h2 class="title-10 smaller anchored" data-anchor-id="installation-data-loading-and-basic-operations">Installation, Data Loading, and Basic Operations</h2>
<p>Install via <code>pip</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install polars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Import polars in your Python code and read data as usual:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_parquet(<span class="st">"s3://nyc-tlc/trip data/yellow_tripdata_2023-06.parquet"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df.head()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>shape: (<span class="dv">5</span>, <span class="dv">19</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>┌──────────┬────────────┬──────────────┬──────────────┬─────┬──────────────┬──────────────┬──────────────┬─────────────┐</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>│ VendorID ┆ tpep_picku ┆ tpep_dropoff ┆ passenger_co ┆ ... ┆ improvement_ ┆ total_amount ┆ congestion_s ┆ Airport_fee │</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>│ <span class="op">---</span>      ┆ p_datetime ┆ _datetime    ┆ unt          ┆     ┆ surcharge    ┆ <span class="op">---</span>          ┆ urcharge     ┆ <span class="op">---</span>         │</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>│ i32      ┆ <span class="op">---</span>        ┆ <span class="op">---</span>          ┆ <span class="op">---</span>          ┆     ┆ <span class="op">---</span>          ┆ f64          ┆ <span class="op">---</span>          ┆ f64         │</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>│          ┆ datetime[n ┆ datetime[ns] ┆ i64          ┆     ┆ f64          ┆              ┆ f64          ┆             │</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>│          ┆ s]         ┆              ┆              ┆     ┆              ┆              ┆              ┆             │</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>╞══════════╪════════════╪══════════════╪══════════════╪═════╪══════════════╪══════════════╪══════════════╪═════════════╡</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>│ <span class="dv">1</span>        ┆ <span class="dv">2023</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> ┆ <span class="dv">2023</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   ┆ <span class="dv">1</span>            ┆ ... ┆ <span class="fl">1.0</span>          ┆ <span class="fl">33.6</span>         ┆ <span class="fl">2.5</span>          ┆ <span class="fl">0.0</span>         │</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>│          ┆ <span class="dv">00</span>:<span class="dv">0</span><span class="er">8</span>:<span class="dv">48</span>   ┆ <span class="dv">00</span>:<span class="dv">29</span>:<span class="dv">41</span>     ┆              ┆     ┆              ┆              ┆              ┆             │</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>│ <span class="dv">1</span>        ┆ <span class="dv">2023</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> ┆ <span class="dv">2023</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   ┆ <span class="dv">0</span>            ┆ ... ┆ <span class="fl">1.0</span>          ┆ <span class="fl">23.6</span>         ┆ <span class="fl">2.5</span>          ┆ <span class="fl">0.0</span>         │</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>│          ┆ <span class="dv">00</span>:<span class="dv">15</span>:<span class="dv">0</span><span class="er">4</span>   ┆ <span class="dv">00</span>:<span class="dv">25</span>:<span class="dv">18</span>     ┆              ┆     ┆              ┆              ┆              ┆             │</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>│ <span class="dv">1</span>        ┆ <span class="dv">2023</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> ┆ <span class="dv">2023</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   ┆ <span class="dv">1</span>            ┆ ... ┆ <span class="fl">1.0</span>          ┆ <span class="fl">60.05</span>        ┆ <span class="fl">0.0</span>          ┆ <span class="fl">1.75</span>        │</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>└──────────┴────────────┴──────────────┴──────────────┴─────┴──────────────┴──────────────┴──────────────┴─────────────┘</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="polars-pipeline-example" class="level2 crunch-title">
<h2 class="crunch-title anchored" data-anchor-id="polars-pipeline-example">Polars Pipeline Example</h2>
<p>We’ll run this as part of the lab in a little bit; <strong>think how you might code this in Pandas…</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/polars-pipeline.png" class="img-fluid figure-img"></p>
<figcaption>Polars pipeline</figcaption>
</figure>
</div>
</section>
<section id="further-reading" class="level2">
<h2 class="anchored" data-anchor-id="further-reading">Further reading</h2>
<ul>
<li><a href="https://github.com/pola-rs/polars">Polars</a></li>
<li><a href="https://pola-rs.github.io/polars-book/user-guide/">User guide</a> ← <strong>MUST READ</strong></li>
<li><a href="https://github.com/pola-rs/polars">Polars GitHub repo</a></li>
<li><a href="https://towardsdatascience.com/pandas-vs-polars-a-syntax-and-speed-comparison-5aa54e27497e">Pandas Vs Polars: a syntax and speed comparison</a></li>
<li><a href="https://towardsdatascience.com/tips-and-tricks-for-working-with-strings-in-polars-ec6bb74aeec2">Tips &amp; tricks for working with strings in Polars</a></li>
</ul>
<!-- Start _duckdb.qmd -->
</section>
</section>
<section id="duckdb" class="level1" data-stack-name="DuckDB">
<h1 data-stack-name="DuckDB">DuckDB</h1>
<p>An in-process SQL OLAP database management system</p>
<section id="duckdb-1" class="level2 text-80">
<h2 class="text-80 anchored" data-anchor-id="duckdb-1">DuckDB</h2>
<ul>
<li><a href="https://duckdb.org/">DuckDB</a> is an in-process <a href="https://en.wikipedia.org/wiki/SQL">SQL</a> <a href="https://en.wikipedia.org/wiki/Online_analytical_processing">OLAP</a> DB management system</li>
<li>Like <code>sqlite</code>, but for analytics. What does this mean? It means that your database runs inside your process, there are no servers to manage, no remote system to connect to. Easy to experiment with SQL-like syntax.</li>
<li><strong>Vectorized processing</strong>: Loads chunks of data into memory (tries to keep everything in the CPU’s L1 and L2 cache) and is thus able to handle datasets bigger than the amount of RAM available.</li>
<li>Supports Python, R and a host of other languages</li>
<li>Important paper on DuckDB: <span class="citation" data-cites="raasveldt_duckdb_2019">Raasveldt and Mühleisen (<a href="#ref-raasveldt_duckdb_2019" role="doc-biblioref">2019</a>)</span></li>
</ul>
</section>
<section id="key-features" class="level2 text-80 crunch-title crunch-li-8">
<h2 class="text-80 crunch-title crunch-li-8 anchored" data-anchor-id="key-features">Key Features</h2>
<ul>
<li><strong>Columnar Storage, Vectorized Query Processing</strong>: DuckDB contains a columnar-vectorized query execution engine, where queries are run on a large batch of values (a “vector”) in one operation
<ul>
<li>Most analytical queries (think group by and summarize) or even data retrieval for training ML models require retrieving a subset of columns and now the entire row, columnar storage make this faster</li>
</ul></li>
<li><strong>In-Memory Processing</strong>: All data needed for processing is brought within the process memory (recall that columnar storage format helps with this) making queries run faster (no DB call over the network)</li>
<li><strong>SQL Support</strong>: highly Postgres-compatible version of SQL<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</li>
<li><strong>ACID Compliance</strong>: Transactional guarantees (ACID properties) through bulk-optimized Multi-Version Concurrency Control (MVCC).</li>
</ul>
</section>
<section id="use-cases-for-duckdb" class="level2 crunch-title text-90">
<h2 class="crunch-title text-90 anchored" data-anchor-id="use-cases-for-duckdb">Use Cases for DuckDB</h2>
<ul>
<li>Data Warehousing</li>
<li>Business Intelligence</li>
<li>Real-Time Analytics</li>
<li>IoT Data Processing</li>
</ul>
<p><strong>DuckDB in the Wild</strong></p>
<ul>
<li><a href="https://mode.com/blog/how-we-switched-in-memory-data-engine-to-duck-db-to-boost-visual-data-exploration-speed/">How We Silently Switched Mode’s In-Memory Data Engine to DuckDB To Boost Visual Data Exploration Speed</a></li>
<li><a href="https://www.rilldata.com/blog/why-we-built-rill-with-duckdb">Why we built Rill with DuckDB</a></li>
<li><a href="https://www.astrafy.io/articles/leveraging-duckdb-for-enhanced-performance-in-dbt-projects">Leveraging DuckDB for enhanced performance in dbt projects</a></li>
</ul>
</section>
<section id="duckdb-diy" class="level2 title-09 crunch-title">
<h2 class="title-09 crunch-title anchored" data-anchor-id="duckdb-diy">DuckDB: DIY</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/duckdb.drawio.png" class="img-fluid figure-img"></p>
<figcaption>Datalake and DuckDB</figcaption>
</figure>
</div>
<p><a href="https://tobilg.com/using-duckdb-in-aws-lambda">Using DuckDB in AWS Lambda</a></p>
</section>
<section id="duckdb-fully-managed" class="level2 smaller crunch-title">
<h2 class="smaller crunch-title anchored" data-anchor-id="duckdb-fully-managed">DuckDB: Fully-Managed</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/motherduck-architecture.png" class="img-fluid figure-img"></p>
<figcaption>MotherDuck Architecture</figcaption>
</figure>
</div>
<ul>
<li><a href="https://motherduck.com/docs/architecture-and-capabilities/">Architecture and capabilities</a></li>
<li>Seamlessly analyze data, whether it sits on your laptop, in the cloud or split between.</li>
<li>Hybrid execution automatically plans each part of your query and determines where it’s best computed</li>
<li><a href="https://kestra.io/blogs/2023-07-28-duckdb-vs-motherduck">DuckDB Vs MotherDuck</a></li>
</ul>
</section>
<section id="setting-up-duckdb" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-duckdb">Setting Up DuckDB</h2>
<p><strong>Configuration and Initialization</strong>: DuckDB is <em>integrated into</em> Python and R for efficient interactive data analysis (APIs for Java, C, C++, Julia, Swift, and others)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install duckdb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Connecting to DuckDB</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># directly query a Pandas DataFrame</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>data_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/anly503/datasets/main/EconomistData.csv"</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(data_url)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">'SELECT * FROM df'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="setting-up-duckdb-contd." class="level2 text-90">
<h2 class="text-90 anchored" data-anchor-id="setting-up-duckdb-contd.">Setting Up DuckDB (contd.)</h2>
<p><strong>Supported data formats</strong>: DuckDB can ingest data from a wide variety of formats – both on-disk and in-memory. See the <a href="https://duckdb.org/docs/api/python/data_ingestion">data ingestion page</a> for more information.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>duckdb.read_csv(<span class="st">'example.csv'</span>)                <span class="co"># read a CSV file into a Relation</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>duckdb.read_parquet(<span class="st">'example.parquet'</span>)        <span class="co"># read a Parquet file into a Relation</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>duckdb.read_json(<span class="st">'example.json'</span>)              <span class="co"># read a JSON file into a Relation</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">'SELECT * FROM "example.csv"'</span>)     <span class="co"># directly query a CSV file</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">'SELECT * FROM "example.parquet"'</span>) <span class="co"># directly query a Parquet file</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">'SELECT * FROM "example.json"'</span>)    <span class="co"># directly query a JSON file</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="querying-duckdb" class="level2 text-90">
<h2 class="text-90 anchored" data-anchor-id="querying-duckdb">Querying DuckDB</h2>
<p><strong>Essential Reading</strong></p>
<ul>
<li><a href="https://duckdb.org/2022/05/04/friendlier-sql.html">Friendlier SQL with DuckDB</a></li>
<li><a href="https://duckdb.org/docs/sql/introduction">SQL Introduction</a></li>
</ul>
<p><strong>Basic SQL Queries</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>babynames <span class="op">=</span> pd.read_parquet(<span class="st">"https://github.com/anly503/datasets/raw/main/babynames.parquet.zstd"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">"select count(*)  from babynames where Name='John'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Aggregations and Grouping</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">"select State, Name, count(*) as count  from babynames group by State, Name order by State desc, count desc"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="querying-duckdb-contd." class="level2 crunch-title text-90">
<h2 class="crunch-title text-90 anchored" data-anchor-id="querying-duckdb-contd.">Querying DuckDB (contd.)</h2>
<p>Essential reading: <a href="https://duckdb.org/docs/sql/query_syntax/from.html"><code>FROM</code> and <code>JOIN</code> clauses</a></p>
<p><strong>Joins and Subqueries</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join two tables together</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">"SELECT * FROM table_name JOIN other_table ON (table_name.key = other_table.key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Window Functions</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>powerplants <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/anly503/datasets/main/powerplants.csv"</span>, parse_dates<span class="op">=</span>[<span class="st">"date"</span>])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT "plant", "date",</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG("MWh") OVER (</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="st">        PARTITION BY "plant"</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="st">        ORDER BY "date" ASC</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="st">        RANGE BETWEEN INTERVAL 3 DAYS PRECEDING</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="st">                  AND INTERVAL 3 DAYS FOLLOWING)</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="st">        AS "MWh 7-day Moving Average"</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="st">FROM powerplants</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY 1, 2;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>duckdb.sql(q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="using-the-duckdb-cli-and-shell" class="level2 crunch-title smaller crunch-ul title-11">
<h2 class="crunch-title smaller crunch-ul title-11 anchored" data-anchor-id="using-the-duckdb-cli-and-shell">Using the DuckDB CLI and Shell</h2>
<ul>
<li><p>Install <a href="http://duckdb.org/docs/installation/">DuckDB CLI</a> or use in browser via <a href="https://shell.duckdb.org/">shell.duckdb.org</a> for data exploration via SQL; Once installed, import a local file into the shell and run queries</p></li>
<li><p>You can download <code>powerplants.csv</code> <a href="https://raw.githubusercontent.com/anly503/datasets/main/powerplants.csv">here</a></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">C:\Users\&lt;username</span><span class="op">&gt;</span><span class="dt">\D</span>ownloads\duckdb_cli-windows-amd64<span class="op">&gt;</span> duckdb</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">v0.8.1</span> 6536a77232</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Enter</span> <span class="st">".help"</span> for usage hints.</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Connected</span> to a transient in-memory database.</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Use</span> <span class="st">".open FILENAME"</span> to reopen on a persistent database.</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="ex">D</span> CREATE TABLE powerplants AS SELECT <span class="pp">*</span> FROM read_csv_auto<span class="er">(</span><span class="st">'powerplants.csv'</span><span class="kw">);</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="ex">D</span> DESCRIBE powerplants<span class="kw">;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="ex">┌─────────────┬─────────────┬─────────┬─────────┬─────────┬───────┐</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span> column_name │ column_type │  null   │   key   │ default │ extra │</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   varchar   │   varchar   │ varchar │ varchar │ varchar │ int32 │</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="ex">├─────────────┼─────────────┼─────────┼─────────┼─────────┼───────┤</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span> plant       │ VARCHAR     │ YES     │         │         │       │</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span> date        │ DATE        │ YES     │         │         │       │</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span> MWh         │ BIGINT      │ YES     │         │         │       │</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="ex">└─────────────┴─────────────┴─────────┴─────────┴─────────┴───────┘</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="ex">D</span>  SELECT <span class="pp">*</span> from powerplants where plant=<span class="st">'Boston'</span> and date=<span class="st">'2019-01-02'</span><span class="kw">;</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="ex">┌─────────┬────────────┬────────┐</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>  plant  │    date    │  MWh   │</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span> varchar │    date    │ int64  │</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="ex">├─────────┼────────────┼────────┤</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span> Boston  │ 2019-01-02 │ 564337 │</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="ex">└─────────┴────────────┴────────┘</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="profiling-in-duckdb" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="profiling-in-duckdb">Profiling in DuckDB</h2>
<p><strong>Query Optimization:</strong> Use <code>EXPLAIN</code> and <code>ANALYZE</code> keywords to understand how your query is being executed and the time being spent in individual steps</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">D</span> EXPLAIN ANALYZE SELECT <span class="pp">*</span> from powerplants where plant=<span class="st">'Boston'</span> and date=<span class="st">'2019-01-02'</span><span class="kw">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>DuckDB will use all the cores available on the underlying compute, but you can adjust this (Full configuration details <a href="https://duckdb.org/docs/sql/configuration.html">here</a>)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>D select current_setting('threads');</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>┌────────────────────────────┐</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>│ current_setting('threads') │</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>│           int64            │</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>├────────────────────────────┤</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>│                          8 │</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>└────────────────────────────┘</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>D SET threads=4;</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>D select current_setting('threads');</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>┌────────────────────────────┐</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>│ current_setting('threads') │</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>│           int64            │</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>├────────────────────────────┤</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>│                          4 │</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>└────────────────────────────┘</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="benchmarks-and-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="benchmarks-and-comparisons">Benchmarks and Comparisons</h2>
<div class="quarto-layout-panel" data-layout="[1,1]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="benchmark-left" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Tricky topic! Can make your chosen solution look better by focusing on metrics on which it provides better results</li>
<li>In general, <a href="https://www.tpc.org/tpch/">TPC-H</a> and <a href="https://www.tpc.org/tpcds/">TPC-DS</a> are considered the standard benchmarks for data processing.</li>
</ul>
</div>
<div id="benchmark-right" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/TPC-DS-Homepage.png" class="img-fluid figure-img"></p>
<figcaption>TPC-DS Homepage</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="further-reading-on-duckdb" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="further-reading-on-duckdb">Further Reading on DuckDB</h2>
<ol type="1">
<li><a href="https://duckdb.org/2022/03/07/aggregate-hashtable.html">Parallel Grouped Aggregation in DuckDB</a></li>
<li><a href="https://duckdb.org/docs/guides/meta/list_tables">Meta queries</a></li>
<li><a href="https://duckdb.org/dev/profiling">Profiling queries in DuckDB</a></li>
<li><a href="https://motherduck.com/blog/duckdb-tutorial-for-beginners/">DuckDB tutorial for beginners</a></li>
<li><a href="https://duckdb.org/docs/api/cli">DuckDB CLI API</a></li>
<li><a href="https://tobilg.com/using-duckdb-in-aws-lambda">Using DuckDB in AWS Lambda</a></li>
<li><a href="https://dagster.io/blog/poor-mans-datalake-motherduck">Revisiting the Poor Man’s Data Lake with MotherDuck</a></li>
<li><a href="https://medium.com/learning-sql/supercharge-your-data-processing-with-duckdb-cea907196704">Supercharge your data processing with DuckDB</a></li>
<li><a href="https://duckdb.org/2022/05/04/friendlier-sql.html">Friendlier SQL with DuckDB</a></li>
<li><a href="https://medium.com/@octavianzarzu/build-and-deploy-apps-with-duckdb-and-streamlit-in-under-one-hour-852cd31cccce">Building and deploying data apps with DuckDB and Streamlit</a></li>
</ol>
</section>
</section>
<section id="lab-4" class="level1" data-stack-name="Lab 4">
<h1 data-stack-name="Lab 4">Lab 4</h1>
<p><a href="https://classroom.github.com/a/I2dS7pSk">GitHub Classroom Link</a></p>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-gopalan_cloud_2022" class="csl-entry" role="listitem">
Gopalan, Rukmani. 2022. <em>The <span>Cloud Data Lake</span>: <span>A Guide</span> to <span>Building Robust Cloud Data Architecture</span></em>. O’Reilly Media, Inc. <a href="https://www.dropbox.com/scl/fi/7u469ccc8y169us5hydk0/The-cloud-data-lake-a-guide-to-building-robust-cloud-data-Rukmani-Gopalan.pdf?rlkey=ey06a6zt9g90d4zq8tfncndta&amp;dl=1">https://www.dropbox.com/scl/fi/7u469ccc8y169us5hydk0/The-cloud-data-lake-a-guide-to-building-robust-cloud-data-Rukmani-Gopalan.pdf?rlkey=ey06a6zt9g90d4zq8tfncndta&amp;dl=1</a>.
</div>
<div id="ref-raasveldt_duckdb_2019" class="csl-entry" role="listitem">
Raasveldt, Mark, and Hannes Mühleisen. 2019. <span>“<span>DuckDB</span>: An <span>Embeddable Analytical Database</span>.”</span> In <em>Proceedings of the 2019 <span>International Conference</span> on <span>Management</span> of <span>Data</span></em>, 1981–84. <span>SIGMOD</span> ’19. New York, NY, USA: Association for Computing Machinery. <a href="https://doi.org/10.1145/3299869.3320212">https://doi.org/10.1145/3299869.3320212</a>.
</div>
<div id="ref-reis_fundamentals_2022" class="csl-entry" role="listitem">
Reis, Joe, and Matt Housley. 2022. <em>Fundamentals of <span>Data Engineering</span>: <span>Plan</span> and <span>Build Robust Data Systems</span></em>. O’Reilly Media, Inc.
</div>
<div id="ref-topol_inmemory_2024" class="csl-entry" role="listitem">
Topol, Matthew, and Wes McKinney. 2024. <em>In-<span>Memory Analytics</span> with <span>Apache Arrow</span></em>. Packt Publishing Ltd.
</div>
<div id="ref-white_hadoop_2015" class="csl-entry" role="listitem">
White, Tom E. 2015. <em>Hadoop: <span>The Definitive Guide</span></em>. O’Reilly Media, Inc.
</div>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://duckdb.org/2022/05/04/friendlier-sql.html">Friendlier SQL with DuckDB</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jpowerj/dsan6000/blob/main/w04/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer></body></html>